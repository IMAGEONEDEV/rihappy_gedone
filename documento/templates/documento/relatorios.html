{% extends "base.html" %}
{% load static %}


{% block extra_css %}
<link rel="stylesheet" href='{% static "\bootstrap\css\relatorios.css" %}'>
{% endblock %}



{% block content %}

    </script>


    <nav class="menu-lateral">
        <div class="btn-expandir">
            <i class="bi bi-list" id="btn-exp"></i>
        </div>

        <ul>
            <h1>
                <i class="bi bi-layout-text-window"></i>
                <span>RELATÓRIOS</span>
            </h1>
            <li class="item-menu" data-target="documentosPendentesForm">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">Documentos Pendentes</span>
                </a>
            </li>
            <li class="item-menu" data-target="documentosExistentesForm">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">Documentos Existentes</span>
                </a>
            </li>

            <li class="item-menu" id="PendenciasASO" data-target="PendenciasASOForm">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">Pendências ASO</span>
                </a>
            </li>

            <li class="item-menu" id="PontoInexistentes" data-target="PontoInexistentesForm">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">Cartões de Ponto Inexistentes</span>
                </a>
            </li>

            <li class="item-menu" id="DocumentosVencidos" data-target="DocumentosVencidosForm">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">Documentos Vencidos</span>
                </a>
            </li>

            <li class="item-menu" id="documentosAVencerItem" data-target="documentosAVencerForm">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">Documentos a Vencer</span>
                </a>
            </li>

            <li class="item-menu" id="DocumentosAuditorias" data-target="DocumentosAuditoriasForm">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">Documentos para Auditorias</span>
                </a>
            </li>

            <li class="item-menu" id="documentosAVencerItem" data-target="documentosAVencerForm">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">Documentos Existentes para Auditorias</span>
                </a>
            </li>
            <h1>
                <i class="bi bi-sliders"></i>
                <span>GERENCIAL</span>
            </h1>
            <li class="item-menu" id="RelatoriosGerenciais" data-target="RelatoriosGerenciaisForm">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">RELATÓRIOS GERENCIAIS</span>
                </a>
            </li>
            <h1>
                <i class="bi bi-clipboard-data"></i>
                <span>BI</span>
            </h1>
            <li class="item-menu">
                <a href="#">
                    <span class="icon"><i class="bi bi-record2-fill"></i></span>
                    <span class="txt-link">Dashboard BI</span>
                </a>
            </li>
        </ul>
    </nav>
    
    <div id="documentosPendentesForm" class="form-container">
        <div class="subheader2">
            <p>DOCUMENTOS PENDENTES</p>
        </div>
        <form>
            <div class="form-row">
                <select id="empresa" name="empresa" placeholder="Empresa" onclick="carregarEmpresas()">
                    <option value="empresa" disabled selected>Empresa</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Regional" name="Regional" placeholder="Regional" onclick="carregarRegional()">
                    <option value="Regional" disabled selected>Regional</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Unidade" name="Unidade" placeholder="Unidade" onclick="carregarUnidade()">
                    <option value="Unidade" disabled selected>Unidade</option>
                </select>
            </div>
            <div class="form-row">
                <input type="text" id="nome" name="nome" placeholder="Nome do Colaborador">
            </div>
            <div class="form-row">
                <input type="text" id="matricula" name="matricula" placeholder="Matrícula">
            </div>
            <div class="form-row">
                <input type="text" id="cpf" name="cpf" placeholder="CPF">
            </div>
            <div class="form-row">
                <select id="Cargo" name="Cargo" placeholder="Cargo" onclick="carregarCargo()">
                    <option value="Cargo" disabled selected>Cargo</option>
                </select>
            </div>
            <div class="form-row">
                <div class="date-row">
                    <input type="date" id="admissao" name="admissao" placeholder="Admissão">
                </div>
                <div class="date-row">
                    <input type="date" id="desligamento" name="desligamento" placeholder="Desligamento">
                </div>
            </div>

            <div class="form-row">
                <select id="situacao" name="situacao" placeholder="Situação">
                    <option value="" disabled selected> Situação </option>
                    <option value="Ativo">Ativo</option>
                    <option value="Inativo">Inativo</option>
                    <option value="Afastado">Afastado</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Tipo_de_Documento" name="Tipo_de_Documento" placeholder="Tipo de Documento" onclick="carregarTipoDeDocumento()">
                    <option value="" disabled selected>Tipo de Documento</option>
                </select>
            </div>
            
            <div class="form-row button-row">
                <button id="pesquisar" type="button">Pesquisar</button>
            </div>
        </form>
    </div>

    </div>

    <div class="sidebar">
        <button class="close-btn">Fechar</button>
        <div class="table-container">
            <div class="subheader3">
                <p>RELATÓRIOS</p>
            </div>
            <div class="export-buttons">
              <select id="exportFormat">
                  <option value="xlsx">Exportar para XLSX</option>
                  <option value="csv">Exportar para CSV</option>
                  <option value="pdf">Exportar para PDF</option>
              </select>
              <button onclick="authenticateDownload()"><i class="bi bi-download"></i></button>
            </div>
            
            <div class="search-container">
              <input type="text" id="searchInput" placeholder="Pesquisar...">
            </div>
                <div class="rows-per-page">
                    <label for="rowsPerPage">Linhas por página:</label>
                    <select id="rowsPerPage" onchange="changeRowsPerPage()">
                      <option value="8">8</option>
                      <option value="10" selected>10</option>
                      <option value="15">15</option>
                      <option value="20">20</option>
                      <option value="40">40</option>
                      <option value="100">100</option>
                  </select>
                </div>
            <table id="tabela-relatorio">
                <thead>
                    <tr>
                        <th>Empresa</th>
                        <th>Regional</th>
                        <th>Unidade</th>
                        <th>Nome do Colaborador</th>
                        <th>Matrícula</th>
                        <th>CPF</th>
                        <th>Cargo</th>
                        <th>Admissão</th>
                        <th>Desligamento</th>
                        <th>Situação</th>
                        <th>Tipo de Documento</th>
                        <th>Visualizar</th> <!-- Nova coluna -->
                    </tr>
                </thead>
                <tbody>
                    <!-- Os dados da tabela serão preenchidos dinamicamente aqui -->
                </tbody>
            </table>
            <div class="pagination" id="pagination">
                <button id="previous-page">&lt; < </button>
                <span id="page-info"></span>
                <button id="next-page"> > &gt;</button>
            </div>
        </div>
        
    </div>
    
    <script>
        // Variáveis para controlar a paginação
        let currentPage = 1;
        let totalPages = 1;
        let itemsPerPage = 8; // Definindo itemsPerPage no escopo global

        document.getElementById('pesquisar').addEventListener('click', function() {
            // Obter os valores dos campos preenchidos do formulário
            var empresa = document.getElementById("empresa").value;
            var regional = document.getElementById("Regional").value;
            var unidade = document.getElementById("Unidade").value;
            var nome = document.getElementById("nome").value.toLowerCase();
            var matricula = document.getElementById("matricula").value.toLowerCase();
            var cpf = document.getElementById("cpf").value.toLowerCase();
            var cargo = document.getElementById("Cargo").value;
            var admissao = document.getElementById("admissao").value;
            var desligamento = document.getElementById("desligamento").value;
            var situacao = document.getElementById("situacao").value;
            var tipoDocumento = document.getElementById("Tipo_de_Documento").value;

            fetch('{% url "carregar_relatorio_pendente_sem_situacao" %}')
                .then(response => response.json())
                .then(data => {
                    const totalItems = data.length;
                    totalPages = Math.ceil(totalItems / itemsPerPage);
                    const start = (currentPage - 1) * itemsPerPage;
                    const end = start + itemsPerPage;

                    const tabela = document.getElementById('tabela-relatorio');
                    const tbody = tabela.getElementsByTagName('tbody')[0];
                    tbody.innerHTML = ''; // Limpa qualquer conteúdo anterior na tabela

                    // Filtrar os dados antes de exibir na tabela
                    const filteredData = data.filter(pendente => {
                        // Compare os valores dos campos do formulário com os valores dos dados obtidos do servidor
                        return (
                            (empresa === "" || pendente.empresa === empresa) &&
                            (regional === "" || pendente.regional === regional) &&
                            (unidade === "" || pendente.unidade === unidade) &&
                            (nome === "" || pendente.nome.toLowerCase().includes(nome)) &&
                            (matricula === "" || pendente.matricula.toLowerCase().includes(matricula)) &&
                            (cpf === "" || pendente.cpf.toLowerCase().includes(cpf)) &&
                            (cargo === "" || pendente.cargo === cargo) &&
                            (admissao === "" || new Date(pendente.admissao) >= new Date(admissao)) &&
                            (desligamento === "" || new Date(pendente.desligamento) >= new Date(desligamento)) &&
                            (situacao === "" || pendente.situacao === situacao) &&
                            (tipoDocumento === "" || pendente.tipo_documento === tipoDocumento)
                        );
                    });

                    // Atualizar o número total de itens após a filtragem
                    totalPages = Math.ceil(filteredData.length / itemsPerPage);

                    // Exibir apenas os dados filtrados na tabela
                    for (let i = start; i < end && i < filteredData.length; i++) {
                        const pendente = filteredData[i];
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${pendente.empresa}</td>
                            <td>${pendente.regional}</td>
                            <td>${pendente.unidade}</td>
                            <td>${pendente.nome}</td>
                            <td>${pendente.matricula}</td>
                            <td>${pendente.cpf}</td>
                            <td>${pendente.cargo}</td>
                            <td>${pendente.admissao}</td>
                            <td>${pendente.desligamento}</td>
                            <td>${pendente.situacao}</td>
                            <td>${pendente.tipo_documento}</td>
                            <td><i class="bi bi-search" onclick="visualizarDetalhes('${pendente.id}', '${pendente.empresa}', '${pendente.regional}', '${pendente.unidade}', '${pendente.nome}', '${pendente.matricula}', '${pendente.cpf}', '${pendente.cargo}', '${pendente.admissao}', '${pendente.desligamento}', '${pendente.situacao}', '${pendente.tipo_documento}')"></i></td> <!-- Ícone de visualização -->
                        `;
                        tbody.appendChild(row);
                    }

                    document.getElementById('page-info').innerText = ` ${currentPage}/${totalPages} `;
                    
                    // Exibe o sidebar após carregar os dados
                    document.querySelector('.sidebar').classList.add('active');
                })
                .catch(error => {
                    console.error('Erro ao carregar os dados:', error);
                });
        });

        document.querySelector('.close-btn').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.remove('active');
        });

        document.getElementById('previous-page').addEventListener('click', function() {
            if (currentPage > 1) {
                currentPage--;
                document.getElementById('pesquisar').click(); // Recarrega os dados da página anterior
            }
        });

        document.getElementById('next-page').addEventListener('click', function() {
            if (currentPage < totalPages) {
                currentPage++;
                document.getElementById('pesquisar').click(); // Recarrega os dados da próxima página
            }
        });

        function visualizarDetalhes(id, empresa, regional, unidade, nome, matricula, cpf, cargo, admissao, desligamento, situacao, tipoDocumento) {
    const nomeColaborador = encodeURIComponent(nome); // Codifica o nome do colaborador para ser usado na URL
    const url = `{% url 'dados_pessoais' %}?id=${id}&empresa=${empresa}&regional=${regional}&unidade=${unidade}&colaborador=${nomeColaborador}&matricula=${matricula}&cpf=${cpf}&cargo=${cargo}&admissao=${admissao}&desligamento=${desligamento}&situacao=${situacao}&tipoDocumento=${tipoDocumento}`;
    window.location.href = url;
}
    </script>
<script>
        // Variáveis globais para armazenar os dados dos documentos pendentes e as seleções do usuário
        var dadosPendentes = null;
        var empresaSelecionada = '';
        var regionalSelecionada = '';
        var unidadeSelecionada = '';
        var cargoSelecionado = '';
    
        // Função para carregar os dados dos documentos pendentes
        function carregarDadosPendentes() {
            $.ajax({
                url: '{% url "carregar_relatorio_pendente_sem_situacao" %}',
                type: 'GET',
                success: function(data) {
                    dadosPendentes = data;
                    // Verifica se já foram feitas seleções de empresa, regional e unidade
                    if (empresaSelecionada) carregarRegional();
                    if (regionalSelecionada) carregarUnidade();
                    if (unidadeSelecionada) carregarCargo();
                },
                error: function(xhr, status, error) {
                    console.error('Erro ao carregar dados dos documentos pendentes:', error);
                }
            });
        }
    
        // Função para carregar as opções de Empresa
        function carregarEmpresas() {
            if (!dadosPendentes) {
                carregarDadosPendentes(); // Carrega os dados dos documentos pendentes se ainda não estiverem carregados
                return;
            }
    
            // Limpa as opções existentes
            $('#empresa').empty().append($('<option>', { value: '', text: 'Selecione a empresa' }));
    
            // Array para armazenar empresas únicas
            var empresas = {};
    
            // Preenche o array com empresas únicas
            dadosPendentes.forEach(function(documento) {
                empresas[documento.empresa] = true;
            });
    
            // Adiciona as empresas únicas ao select
            Object.keys(empresas).forEach(function(empresa) {
                var option = $('<option>', { value: empresa, text: empresa });
                $('#empresa').append(option);
            });
    
            // Define novamente a seleção de empresa
            $('#empresa').val(empresaSelecionada);
        }
    
        // Função para carregar as opções de Regional de acordo com a Empresa selecionada
        function carregarRegional() {
            var empresaSelecionada = $('#empresa').val();
    
            // Verifica se uma empresa foi selecionada
            if (!empresaSelecionada) {
                console.error('Por favor, selecione uma empresa antes de carregar as regionais.');
                return;
            }
    
            // Limpa as opções existentes
            $('#Regional').empty().append($('<option>', { value: '', text: 'Selecione a Regional' }));
    
            // Array para armazenar regionais únicas
            var regionais = {};
    
            // Preenche o array com regionais únicas
            dadosPendentes.forEach(function(documento) {
                if (documento.empresa === empresaSelecionada) {
                    regionais[documento.regional] = true;
                }
            });
    
            // Adiciona as regionais únicas ao select
            Object.keys(regionais).forEach(function(regional) {
                var option = $('<option>', { value: regional, text: regional });
                $('#Regional').append(option);
            });
    
            // Define novamente a seleção de regional
            $('#Regional').val(regionalSelecionada);
        }
    
        // Função para carregar as opções de Unidade de acordo com a Regional selecionada
        function carregarUnidade() {
            var regionalSelecionada = $('#Regional').val();
    
            // Verifica se uma Regional foi selecionada
            if (!regionalSelecionada) {
                console.error('Por favor, selecione uma regional antes de carregar as unidades.');
                return;
            }
    
            // Limpa as opções existentes
            $('#Unidade').empty().append($('<option>', { value: '', text: 'Selecione a Unidade' }));
    
            // Array para armazenar unidades únicas
            var unidades = {};
    
            // Preenche o array com unidades únicas
            dadosPendentes.forEach(function(documento) {
                if (documento.regional === regionalSelecionada) {
                    unidades[documento.unidade] = true;
                }
            });
    
            // Adiciona as unidades únicas ao select
            Object.keys(unidades).forEach(function(unidade) {
                var option = $('<option>', { value: unidade, text: unidade });
                $('#Unidade').append(option);
            });
    
            // Define novamente a seleção de unidade
            $('#Unidade').val(unidadeSelecionada);
        }
    
        // Função para carregar as opções de Cargo
        function carregarCargo() {
            // Verifica se os dados dos documentos pendentes estão disponíveis
            if (!dadosPendentes) {
                console.error('Os dados dos documentos pendentes não foram carregados ainda.');
                return;
            }
    
            // Limpa as opções existentes
            $('#Cargo').empty().append($('<option>', { value: '', text: 'Selecione o Cargo' }));
    
            // Array para armazenar cargos únicos
            var cargos = {};
    
            // Preenche o array com cargos únicos
            dadosPendentes.forEach(function(documento) {
                cargos[documento.cargo] = true;
            });
    
            // Adiciona os cargos únicos ao select
            Object.keys(cargos).forEach(function(cargo) {
                var option = $('<option>', { value: cargo, text: cargo });
                $('#Cargo').append(option);
            });
    
            // Define novamente a seleção de cargo
            $('#Cargo').val(cargoSelecionado);
        }
    
        // Função para limpar as seleções de Regional e Unidade
        function limparRegionalUnidade() {
            regionalSelecionada = ''; // Limpa a seleção de Regional
            unidadeSelecionada = ''; // Limpa a seleção de Unidade
            $('#Regional').empty().append($('<option>', { value: '', text: 'Selecione a Regional' })); // Limpa as opções de Regional
            $('#Unidade').empty().append($('<option>', { value: '', text: 'Selecione a Unidade' })); // Limpa as opções de Unidade
        }
    
        // Funções para atualizar as seleções de Regional, Unidade e Cargo quando a Empresa é selecionada
        $('#empresa').change(function() {
            empresaSelecionada = $(this).val();
            limparRegionalUnidade(); // Limpa as seleções de Regional e Unidade
            carregarRegional();
            carregarUnidade();
            carregarCargo();
        });
    
        // Função para atualizar as seleções de Unidade e Cargo quando a Regional é selecionada
        $('#Regional').change(function() {
            regionalSelecionada = $(this).val();
            carregarUnidade();
            carregarCargo();
        });
    
        // Função para atualizar a seleção de Cargo quando a Unidade é selecionada
        $('#Unidade').change(function() {
            unidadeSelecionada = $(this).val();
            carregarCargo();
        });
    
        // Função para armazenar a seleção de Cargo quando o valor do select é alterado
        $('#Cargo').change(function() {
            cargoSelecionado = $(this).val();
        });
    
        // Carrega as opções de Empresa assim que a página carregar
        $(document).ready(function() {
            carregarEmpresas();
            carregarCargo(); // Chama a função para carregar as opções de Cargo assim que a página carregar
        });
    </script>
    

    <script>
        $(document).ready(function() {
            carregarTipoDeDocumento();  // Chama a função assim que a página for carregada
        });
        
        var tiposDocumentoCarregados = false;  // Variável para controlar se os tipos de documento já foram carregados
        
        function carregarTipoDeDocumento() {
            // Verifica se os tipos de documento já foram carregados antes de fazer uma nova solicitação
            if (!tiposDocumentoCarregados) {
                $.ajax({
                    url: '{% url "cadastrar_tipodocumento" %}',  // Substitua pelo URL correto
                    type: 'GET',
                    success: function(data) {
                        var select = $('#Tipo_de_Documento');
                        select.empty();
                        select.append('<option value="" disabled selected>Tipo de Documento</option>');
                        $.each(data, function(index, tipoDocumento) {
                            select.append('<option value="' + tipoDocumento.id + '">' + tipoDocumento.nome + '</option>');
                        });
                        tiposDocumentoCarregados = true;  // Atualiza a variável para indicar que os tipos de documento foram carregados
                    },
                    error: function(xhr, status, error) {
                        console.error('Erro ao carregar tipos de documento:', error);
                    }
                });
            }
        }
        </script>
        
        
    
        <div id="documentosExistentesForm" class="form-container">
            <div class="subheader2">
                <p>DOCUMENTOS EXISTENTES</p>
            </div>
            <form>
                <div class="form-row">
                    <select id="empresaDocumentos" name="empresaDocumentos" placeholder="Empresa" onclick="carregarEmpresas()">
                        <option value="empresa" disabled selected>Empresa</option>
                    </select>
                </div>
                <div class="form-row">
                    <select id="regionalDocumentos" name="regionalDocumentos" placeholder="Regional" onclick="carregarRegional()">
                        <option value="regional" disabled selected>Regional</option>
                    </select>
                </div>
                <div class="form-row">
                    <select id="unidadeDocumentos" name="unidadeDocumentos" placeholder="Unidade" onclick="carregarUnidade()">
                        <option value="unidade" disabled selected>Unidade</option>
                    </select>
                </div>
                <div class="form-row">
                    <input type="text" id="nomeDocumento" name="nomeDocumento" placeholder="Nome do Colaborador">
                </div>
                <div class="form-row">
                    <input type="text" id="matriculaDocumento" name="matriculaDocumento" placeholder="Matrícula">
                </div>
                <div class="form-row">
                    <input type="text" id="cpfDocumento" name="cpfDocumento" placeholder="CPF">
                </div>
                <div class="form-row">
                    <select id="cargoDocumentos" name="cargoDocumentos" placeholder="Cargo" onclick="carregarCargo()">
                        <option value="cargo" disabled selected>Cargo</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="date-row">
                        <input type="text" id="admissaoDocumento" placeholder="Admissão" onfocus="(this.type='date')" onblur="(this.type='text')" pattern="\d{2}/\d{2}/\d{4}" title="Digite a data no formato dd/mm/aaaa">
                    </div>
                    <div class="date-row">
                        <input type="text" id="desligamentoDocumento" placeholder="Desligamento" onfocus="(this.type='date')" onblur="(this.type='text')" pattern="\d{2}/\d{2}/\d{4}" title="Digite a data no formato dd/mm/aaaa">
                    </div>
                </div>
                <div class="form-row">
                    <select id="situacaoDocumento" name="situacaoDocumento" placeholder="Situação"></select>
                </div>
                <div class="form-row">
                    <select id="tipoDocumento" name="tipoDocumento" placeholder="Tipo de Documento" onclick="carregarTipoDeDocumento()">
                        <option value="tipoDocumento" disabled selected>Tipo de Documento</option>
                    </select>
                </div>  
                <div class="form-row button-row">
                    <button id="pesquisarExistentes" type="button">Pesquisar</button>
                </div>
            </form>
        </div>
        <script>
            document.getElementById('admissaoDocumento').addEventListener('blur', function() {
                if (this.value !== '') {
                    var parts = this.value.split('-');
                    var formattedDate = parts[2] + '/' + parts[1] + '/' + parts[0];
                    this.value = formattedDate;
                }
            });
            document.getElementById('desligamentoDocumento').addEventListener('blur', function() {
                if (this.value !== '') {
                    var parts = this.value.split('-');
                    var formattedDate = parts[2] + '/' + parts[1] + '/' + parts[0];
                    this.value = formattedDate;
                }
            });
            </script>
<script>
    // Função para converter uma string de data no formato "dd/mm/yyyy" para um objeto Date
    function parseDate(dateString) {
        const [day, month, year] = dateString.split('/');
        return new Date(year, month - 1, day); // Mês é base 0 no objeto Date
    }
    
    // Função para verificar se duas datas são iguais (apenas ano, mês e dia)
    function datasIguais(data1, data2) {
        return (
            data1.getFullYear() === data2.getFullYear() &&
            data1.getMonth() === data2.getMonth() &&
            data1.getDate() === data2.getDate()
        );
    }
    
    // Função para abrir o sidebar e preencher a tabela com os dados da view
    function openSidebarAndFillTable() {
        // Selecionando a empresa, regional, unidade, nome do colaborador, matrícula do colaborador, CPF do colaborador, cargo do colaborador, data de admissão e data de desligamento do colaborador
        const selectedEmpresa = document.getElementById('empresaDocumentos').value;
        const selectedRegional = document.getElementById('regionalDocumentos').value;
        const selectedUnidade = document.getElementById('unidadeDocumentos').value;
        const nomeColaborador = document.getElementById('nomeDocumento').value.trim().toLowerCase(); // Convertendo para minúsculas e removendo espaços extras
        const matriculaColaborador = document.getElementById('matriculaDocumento').value.trim(); // Removendo espaços extras
        const cpfColaborador = document.getElementById('cpfDocumento').value.trim(); // Removendo espaços extras
        const selectedCargo = document.getElementById('cargoDocumentos').value;
        const admissaoColaborador = document.getElementById('admissaoDocumento').value; // Obtendo a data de admissão
        const desligamentoColaborador = document.getElementById('desligamentoDocumento').value; // Obtendo a data de desligamento
        const selectedSituacao = document.getElementById('situacaoDocumento').value; // Obtendo a situação selecionada
        const selectedTipoDocumento = document.getElementById('tipoDocumento').value; // Obtendo o tipo de documento selecionado
    
        // Convertendo a data de admissão e desligamento para objetos Date, se estiverem preenchidas
        const admissaoColaboradorDate = admissaoColaborador ? parseDate(admissaoColaborador) : null;
        const desligamentoColaboradorDate = desligamentoColaborador ? parseDate(desligamentoColaborador) : null;
    
        // Verificando se um nome de colaborador foi inserido
        const nomeFiltrado = nomeColaborador !== '';
    
        // Fazendo uma requisição AJAX para a view
        const xhr = new XMLHttpRequest();
        xhr.open('GET', "{% url 'relatorio_existente_todos_sem_situacao' %}", true); // Substitua '/url/da/view' pela URL correta da sua view
        xhr.onload = function () {
            if (xhr.status >= 200 && xhr.status < 300) {
                const data = JSON.parse(xhr.responseText);
    
                // Selecionando o corpo da tabela
                const tbody = document.querySelector('#tabela-relatorio tbody');
                tbody.innerHTML = ''; // Limpa o conteúdo atual da tabela
    
                // Iterando sobre os dados e preenchendo a tabela
                for (const situacao in data) {
                    if (data.hasOwnProperty(situacao)) {
                        data[situacao].forEach(function (item) {
                            // Verificando se a empresa, regional, unidade, nome do colaborador, matrícula do colaborador, CPF do colaborador, cargo do colaborador, data de admissão e data de desligamento do colaborador na linha da tabela correspondem aos valores selecionados e inseridos
                            const nomeColaboradorValido = nomeFiltrado ? item.nome.toLowerCase().includes(nomeColaborador) : true;
                            const matriculaColaboradorValida = matriculaColaborador !== '' ? item.matricula === matriculaColaborador : true;
                            const cpfColaboradorValido = cpfColaborador !== '' ? item.cpf === cpfColaborador : true;
                            const cargoColaboradorValido = selectedCargo !== '' ? item.cargo === selectedCargo : true;
                            const admissaoColaboradorValida = admissaoColaborador ? datasIguais(parseDate(item.admissao), admissaoColaboradorDate) : true;
                            const desligamentoColaboradorValido = desligamentoColaborador ? datasIguais(parseDate(item.desligamento), desligamentoColaboradorDate) : true;
                            const situacaoValida = selectedSituacao !== '' ? item.situacao === selectedSituacao : true;
                            const tipoDocumentoValido = selectedTipoDocumento !== '' ? item.documento === selectedTipoDocumento : true;
    
                            if ((selectedEmpresa === '' || item.empresa === selectedEmpresa) &&
                                (selectedRegional === '' || item.regional === selectedRegional) &&
                                (selectedUnidade === '' || item.unidade === selectedUnidade) &&
                                nomeColaboradorValido && matriculaColaboradorValida && cpfColaboradorValido && cargoColaboradorValido && admissaoColaboradorValida && desligamentoColaboradorValido && situacaoValida && tipoDocumentoValido) {
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td>${item.empresa}</td>
                                    <td>${item.regional}</td>
                                    <td>${item.unidade}</td>
                                    <td>${item.nome}</td>
                                    <td>${item.matricula}</td>
                                    <td>${item.cpf}</td>
                                    <td>${item.cargo}</td>
                                    <td>${item.admissao}</td>
                                    <td>${item.desligamento}</td>
                                    <td>${item.situacao}</td>
                                    <td>${item.documento}</td>
                                    <td><i class="bi bi-search"></td>
                                `;
                                tbody.appendChild(row);
                            }
                        });
                    }
                }

                // Abrindo a sidebar após preencher a tabela
                const sidebar = document.querySelector('.sidebar');
                sidebar.classList.add('active');
            } else {
                console.error('Erro ao carregar os dados da view');
            }
        };
        xhr.send();
    }
    
    // Adicionando evento de clique ao botão de pesquisar
    const pesquisarBtn = document.getElementById('pesquisarExistentes');
    pesquisarBtn.addEventListener('click', openSidebarAndFillTable);
    
    // Função para visualizar o documento (substitua por sua lógica real)
    function visualizarDocumento(id) {
        console.log('Visualizando documento com o ID:', id);
    }
    
    // Função para fechar o sidebar
    function closeSidebar() {
        const sidebar = document.querySelector('.sidebar');
        sidebar.classList.remove('active');
    }
    
    // Adicionando evento de clique ao botão de fechar
    const closeBtn = document.querySelector('.close-btn');
    closeBtn.addEventListener('click', closeSidebar);
    
    </script>
    
    
    

        <script>
            $(document).ready(function() {
                // Função para carregar as opções de empresas, regiões, unidades, cargos, situações e tipos de documento
                function carregarOpcoes() {
                    $.ajax({
                        url: "{% url 'relatorio_existente_todos_sem_situacao' %}",
                        type: 'GET',
                        dataType: 'json',
                        success: function(data) {
                            // Criar conjuntos para armazenar empresas, regiões, unidades, cargos, situações e tipos de documento únicos
                            var empresasSet = new Set();
                            var regioesSet = new Set();
                            var unidadesSet = new Set();
                            var cargosSet = new Set();
                            var situacoesSet = new Set();
                            var tiposDocumentoSet = new Set();
                            
                            // Adicionar empresas, regiões, unidades, cargos, situações e tipos de documento únicos aos conjuntos
                            Object.keys(data).forEach(function(status) {
                                data[status].forEach(function(pendente) {
                                    empresasSet.add(pendente.empresa);
                                    regioesSet.add(pendente.regional);
                                    unidadesSet.add(pendente.unidade);
                                    cargosSet.add(pendente.cargo);
                                    situacoesSet.add(pendente.situacao);
                                    tiposDocumentoSet.add(pendente.documento);
                                });
                            });
                            
                            // Limpar as opções de empresas, regiões, unidades, cargos, situações e tipos de documento existentes
                            $('#empresaDocumentos').empty().append('<option value="" disabled selected>Empresa</option>');
                            $('#regionalDocumentos').empty().append('<option value="" disabled selected>Regional</option>');
                            $('#unidadeDocumentos').empty().append('<option value="" disabled selected>Unidade</option>');
                            $('#cargoDocumentos').empty().append('<option value="" disabled selected>Cargo</option>');
                            $('#situacaoDocumento').empty().append('<option value="" disabled selected>Situação</option>');
                            $('#tipoDocumento').empty().append('<option value="" disabled selected>Tipo de Documento</option>');
                            
                            // Adicionar as novas opções baseadas nas empresas únicas
                            empresasSet.forEach(function(empresa) {
                                $('#empresaDocumentos').append($('<option>', {
                                    value: empresa,
                                    text: empresa
                                }));
                            });
                            
                            // Adicionar as novas opções baseadas nas regiões únicas
                            regioesSet.forEach(function(regional) {
                                $('#regionalDocumentos').append($('<option>', {
                                    value: regional,
                                    text: regional
                                }));
                            });
                            
                            // Adicionar as novas opções baseadas nas unidades únicas
                            unidadesSet.forEach(function(unidade) {
                                $('#unidadeDocumentos').append($('<option>', {
                                    value: unidade,
                                    text: unidade
                                }));
                            });
            
                            // Adicionar as novas opções baseadas nos cargos únicos
                            cargosSet.forEach(function(cargo) {
                                $('#cargoDocumentos').append($('<option>', {
                                    value: cargo,
                                    text: cargo
                                }));
                            });
            
                            // Adicionar as novas opções baseadas nas situações únicas
                            situacoesSet.forEach(function(situacao) {
                                $('#situacaoDocumento').append($('<option>', {
                                    value: situacao,
                                    text: situacao
                                }));
                            });
            
                            // Adicionar as novas opções baseadas nos tipos de documento únicos
                            tiposDocumentoSet.forEach(function(tipoDocumento) {
                                $('#tipoDocumento').append($('<option>', {
                                    value: tipoDocumento,
                                    text: tipoDocumento
                                }));
                            });
                        },
                        error: function() {
                            // Em caso de erro, você pode lidar com isso aqui
                            console.error('Erro ao carregar as empresas, regiões, unidades, cargos, situações e tipos de documento.');
                        }
                    });
                }
            
                // Chamar a função carregarOpcoes assim que a página é carregada
                carregarOpcoes();
            
                // Função para carregar informações relacionadas à empresa selecionada
                $('#empresaDocumentos').on('change', function() {
                    carregarInformacoesEmpresa();
                });
            
                // Função para carregar informações relacionadas à região selecionada
                $('#regionalDocumentos').on('change', function() {
                    carregarInformacoesRegional();
                });
            
                // Função para carregar informações relacionadas à unidade selecionada
                $('#unidadeDocumentos').on('change', function() {
                    carregarInformacoesUnidade();
                });
            
                // Função para carregar informações relacionadas ao cargo selecionado
                $('#cargoDocumentos').on('change', function() {
                    carregarInformacoesCargo();
                });
            
                // Função para carregar informações relacionadas à situação selecionada
                $('#situacaoDocumento').on('change', function() {
                    carregarInformacoesSituacao();
                });
            
                // Função para carregar informações relacionadas ao tipo de documento selecionado
                $('#tipoDocumento').on('change', function() {
                    carregarInformacoesTipoDocumento();
                });
            
                // Função para carregar informações relacionadas à empresa selecionada
                function carregarInformacoesEmpresa() {
                    var empresaSelecionada = $('#empresaDocumentos').val(); // Obter o valor da empresa selecionada
                    if (empresaSelecionada) {
                        $('#campoInformacaoEmpresa').val(empresaSelecionada); // Atualizar o valor do campo com a informação da empresa selecionada
                    } else {
                        $('#campoInformacaoEmpresa').attr('placeholder', 'Empresa'); // Definir o placeholder como 'Empresa' se nenhuma empresa for selecionada
                    }
                }
            
                // Função para carregar informações relacionadas à região selecionada
                function carregarInformacoesRegional() {
                    var regionalSelecionada = $('#regionalDocumentos').val(); // Obter o valor da região selecionada
                    if (regionalSelecionada) {
                        $('#campoInformacaoRegional').val(regionalSelecionada); // Atualizar o valor do campo com a informação da região selecionada
                    } else {
                        $('#campoInformacaoRegional').attr('placeholder', 'Regional'); // Definir o placeholder como 'Regional' se nenhuma região for selecionada
                    }
                }
            
                // Função para carregar informações relacionadas à unidade selecionada
                function carregarInformacoesUnidade() {
                    var unidadeSelecionada = $('#unidadeDocumentos').val(); // Obter o valor da unidade selecionada
                    if (unidadeSelecionada) {
                        $('#campoInformacaoUnidade').val(unidadeSelecionada); // Atualizar o valor do campo com a informação da unidade selecionada
                    } else {
                        $('#campoInformacaoUnidade').attr('placeholder', 'Unidade'); // Definir o placeholder como 'Unidade' se nenhuma unidade for selecionada
                    }
                }
            
                // Função para carregar informações relacionadas ao cargo selecionado
                function carregarInformacoesCargo() {
                    var cargoSelecionado = $('#cargoDocumentos').val(); // Obter o valor do cargo selecionado
                    if (cargoSelecionado) {
                        $('#campoInformacaoCargo').val(cargoSelecionado); // Atualizar o valor do campo com a informação do cargo selecionado
                    } else {
                        $('#campoInformacaoCargo').attr('placeholder', 'Cargo'); // Definir o placeholder como 'Cargo' se nenhum cargo for selecionado
                    }
                }
            
                // Função para carregar informações relacionadas à situação selecionada
                function carregarInformacoesSituacao() {
                    var situacaoSelecionada = $('#situacaoDocumento').val(); // Obter o valor da situação selecionada
                    if (situacaoSelecionada) {
                        $('#campoInformacaoSituacao').val(situacaoSelecionada); // Atualizar o valor do campo com a informação da situação selecionada
                    } else {
                        $('#campoInformacaoSituacao').attr('placeholder', 'Situação'); // Definir o placeholder como 'Situação' se nenhuma situação for selecionada
                    }
                }
            
                // Função para carregar informações relacionadas ao tipo de documento selecionado
                function carregarInformacoesTipoDocumento() {
                    var tipoDocumentoSelecionado = $('#tipoDocumento').val(); // Obter o valor do tipo de documento selecionado
                    if (tipoDocumentoSelecionado) {
                        $('#campoInformacaoTipoDocumento').val(tipoDocumentoSelecionado); // Atualizar o valor do campo com a informação do tipo de documento selecionado
                    } else {
                        $('#campoInformacaoTipoDocumento').attr('placeholder', 'Tipo de Documento'); // Definir o placeholder como 'Tipo de Documento' se nenhum tipo de documento for selecionado
                    }
                }
            });

          
            </script>
            
            


            <div id="PendenciasASOForm" class="form-container">
                <div class="subheader2">
                    <p>Pendências ASO</p>
                </div>
                <form>
                    <div class="form-row">
                        <select id="empresaASO" name="empresaASO" placeholder="Empresa" >
                            <option value="empresaASO" disabled selected>Empresa</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <select id="RegionalASO" name="RegionalASO" placeholder="Regional" >
                            <option value="RegionalASO" disabled selected>Regional</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <select id="UnidadeASO" name="UnidadeASO" placeholder="Unidade" >
                            <option value="UnidadeASO" disabled selected>Unidade</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <input type="text" id="nomeASO" name="nomeASO" placeholder="Nome do Colaborador">
                    </div>
                    <div class="form-row">
                        <input type="text" id="matriculaASO" name="matriculaASO" placeholder="Matrícula">
                    </div>
                    <div class="form-row">
                        <input type="text" id="cpfASO" name="cpfASO" placeholder="CPF">
                    </div>
                    <div class="form-row">
                        <select id="CargoASO" name="CargoASO" placeholder="Cargo" >
                            <option value="CargoASO" disabled selected>Cargo</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="date-row">
                            <input type="text" id="admissaoASO" placeholder="Admissão" onfocus="(this.type='date')" onblur="(this.type='text')" pattern="\d{2}/\d{2}/\d{4}" title="Digite a data no formato dd/mm/aaaa">
                        </div>
                        <div class="date-row">
                            <input type="text" id="desligamentoASO" placeholder="Desligamento" onfocus="(this.type='date')" onblur="(this.type='text')" pattern="\d{2}/\d{2}/\d{4}" title="Digite a data no formato dd/mm/aaaa">
                        </div>
                    </div>
                    <div class="form-row">
                        <select id="situacaoASO" name="situacaoASO" placeholder="Situação" >
                            <option value="" disabled selected> Situação </option>
                        </select>
                    </div>
                    <div class="form-row">
                        <select id="TipoDeDocumentoASO" name="TipoDeDocumentoASO" placeholder="Tipo de Documento" >
                            <option value="TipoDeDocumentoASO" disabled selected>Tipo de Documento</option>
                        </select>
                    </div>  
                    <div class="form-row button-row">
                        <button id="pesquisarASO" type="button">Pesquisar</button>
                    </div>
                </form>
            </div>

            <script>
                document.getElementById('admissaoASO').addEventListener('blur', function() {
                    if (this.value !== '') {
                        var parts = this.value.split('-');
                        var formattedDate = parts[2] + '/' + parts[1] + '/' + parts[0];
                        this.value = formattedDate;
                    }
                });
                document.getElementById('desligamentoASO').addEventListener('blur', function() {
                    if (this.value !== '') {
                        var parts = this.value.split('-');
                        var formattedDate = parts[2] + '/' + parts[1] + '/' + parts[0];
                        this.value = formattedDate;
                    }
                });
                </script>

                
            <script>
                var urlCarregarRelatorio = "{% url 'carregar_relatorio_pendente_asos' %}";
            
                // Função genérica para carregar opções de um select
                function carregarOpcoes(selectId, propriedade, selecionada, placeholder) {
                    var select = document.getElementById(selectId);
                    if (selecionada !== '') {
                        return;
                    }
                    var xhr = new XMLHttpRequest();
                    xhr.open("GET", urlCarregarRelatorio, true);
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 4 && xhr.status == 200) {
                            var documentos = JSON.parse(xhr.responseText);
                            var opcoesUnicas = new Set();
                            select.innerHTML = '<option value="" disabled selected>' + placeholder + '</option>';
                            documentos.forEach(function(documento) {
                                opcoesUnicas.add(documento[propriedade]);
                            });
                            opcoesUnicas.forEach(function(opcao) {
                                var option = document.createElement("option");
                                option.text = opcao;
                                option.value = opcao;
                                select.add(option);
                            });
                            if (selecionada !== '') {
                                select.value = selecionada;
                            }
                        }
                    };
                    xhr.send();
                }
            
                // Primeiro conjunto de scripts
                var empresaSelecionadaPrimeiro = '';
            
                function carregarEmpresasPrimeiro() {
                    carregarOpcoes("empresaASO", "empresa", empresaSelecionadaPrimeiro, "Empresa");
                }
            
                document.getElementById("empresaASO").addEventListener("change", function() {
                    empresaSelecionadaPrimeiro = this.value;
                });
            
                // Chamada da função carregarEmpresasPrimeiro() quando a janela terminar de carregar
                window.onload = function() {
                    carregarEmpresasPrimeiro();
                    carregarOpcoes("RegionalASO", "regional", "", "Regional"); // Chamando a função para carregar as opções do RegionalASO também
                    carregarOpcoes("UnidadeASO", "unidade", "", "Unidade"); // Chamando a função para carregar as opções do UnidadeASO também
                    carregarOpcoes("CargoASO", "cargo", "", "Cargo"); // Chamando a função para carregar as opções do CargoASO também
                    carregarOpcoes("situacaoASO", "status", "", "Situação"); // Chamando a função para carregar as opções do SituaçãoASO também
                    carregarOpcoes("TipoDeDocumentoASO", "tipo_documento", "", "Tipo de Documento"); // Chamando a função para carregar as opções do TipoDeDocumentoASO também
                };
            </script>
            
            <script>
              function openSidebarASO() {
    // Obter o valor selecionado nos selects de empresa, regional, unidade, cargo, situação e tipo de documento
    const selectedEmpresa = document.getElementById('empresaASO').value;
    const selectedRegional = document.getElementById('RegionalASO').value;
    const selectedUnidade = document.getElementById('UnidadeASO').value;
    const selectedCargo = document.getElementById('CargoASO').value;
    const selectedSituacao = document.getElementById('situacaoASO').value;
    const selectedTipoDeDocumento = document.getElementById('TipoDeDocumentoASO').value;

    // Obter os valores dos inputs de texto para nome, matrícula, CPF, admissão e desligamento
    const nomeASO = document.getElementById('nomeASO').value.toLowerCase();
    const matriculaASO = document.getElementById('matriculaASO').value.toLowerCase();
    const cpfASO = document.getElementById('cpfASO').value.toLowerCase();
    const admissaoASO = document.getElementById('admissaoASO').value;
    const desligamentoASO = document.getElementById('desligamentoASO').value;

    // Realizar uma solicitação AJAX para a view
    const xhr = new XMLHttpRequest();
    xhr.open('GET', "{% url 'carregar_relatorio_pendente_asos' %}", true);
    xhr.onload = function () {
        if (xhr.status >= 200 && xhr.status < 300) {
            const data = JSON.parse(xhr.responseText);
            const tbody = document.querySelector('#tabela-relatorio tbody');
            tbody.innerHTML = ''; // Limpar o conteúdo atual da tabela

            // Iterar sobre os dados e preencher a tabela
            data.forEach(function (item) {
                // Verificar se a linha corresponde a todos os filtros selecionados
                if ((selectedEmpresa === '' || item.empresa === selectedEmpresa) &&
                    (selectedRegional === '' || item.regional === selectedRegional) &&
                    (selectedUnidade === '' || item.unidade === selectedUnidade) &&
                    (selectedCargo === '' || item.cargo === selectedCargo) &&
                    (selectedSituacao === '' || item.status === selectedSituacao) &&
                    (selectedTipoDeDocumento === '' || item.tipo_documento === selectedTipoDeDocumento) &&
                    (nomeASO === '' || item.nome.toLowerCase().includes(nomeASO)) &&
                    (matriculaASO === '' || item.matricula.toLowerCase().includes(matriculaASO)) &&
                    (cpfASO === '' || item.cpf.toLowerCase().includes(cpfASO)) &&
                    (admissaoASO === '' || item.admissao === admissaoASO) &&
                    (desligamentoASO === '' || item.desligamento === desligamentoASO)) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.empresa}</td>
                        <td>${item.regional}</td>
                        <td>${item.unidade}</td>
                        <td>${item.nome}</td>
                        <td>${item.matricula}</td>
                        <td>${item.cpf}</td>
                        <td>${item.cargo}</td>
                        <td>${item.admissao}</td>
                        <td>${item.desligamento}</td>
                        <td>${item.status}</td>
                        <td>${item.tipo_documento}</td>
                        <td><button onclick="visualizarDocumento('${item.id}')">Visualizar</button></td>
                    `;
                    tbody.appendChild(row);
                }
            });

            // Abrir o sidebar após preencher a tabela
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.add('active');
        } else {
            console.error('Erro ao carregar os dados da view');
        }
    };
    xhr.send();
}

// Adicionando evento de clique ao botão de pesquisarASO
const pesquisarBtnASO = document.getElementById('pesquisarASO');
pesquisarBtnASO.addEventListener('click', openSidebarASO);

// Função para fechar o sidebar do ASO
function closeSidebarASO() {
    const sidebar = document.querySelector('.sidebar');
    sidebar.classList.remove('active');
}

// Adicionando evento de clique ao botão de fechar do ASO
const closeBtnASO = document.querySelector('.close-btn-aso');
closeBtnASO.addEventListener('click', closeSidebarASO);

// Função para visualizar o documento (substitua por sua lógica real)
function visualizarDocumento(id) {
    console.log('Visualizando documento com o ID:', id);
}

            </script>
            
            
            
            
            
            
                
            




            <div id="PontoInexistentesForm" class="form-container">
                <div class="subheader2">
                    <p>CARTÕES DE PONTO INEXISTENTES</p>
                </div>
                <form>
                    <div class="form-row">
                        <select id="empresaCartoes" name="empresaCartoes" placeholder="Empresa" >
                            <option value="empresaCartoes" disabled selected>Empresa</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <select id="RegionalCartoes" name="RegionalCartoes" placeholder="Regional" >
                            <option value="RegionalCartoes" disabled selected>Regional</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <select id="UnidadeCartoes" name="UnidadeCartoes" placeholder="Unidade" >
                            <option value="UnidadeCartoes" disabled selected>Unidade</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <input type="text" id="nomeCartoes" name="nomeCartoes" placeholder="Nome do Colaborador">
                    </div>
            
                    <div class="form-row">
                        <select id="situacaoCartoes" name="situacaoCartoes" placeholder="Situação">
                            <option value="" disabled selected> Situação </option>
                            <option value="ativo">Ativo</option>
                            <option value="inativo">Inativo</option>
                            <option value="afastado">Afastado</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="date-row">
                            <select id="mesCartoes" name="mesCartoes">
                                <option value="01">Janeiro</option>
                                <option value="02">Fevereiro</option>
                                <option value="03">Março</option>
                                <option value="04">Abril</option>
                                <option value="05">Maio</option>
                                <option value="06">Junho</option>
                                <option value="07">Julho</option>
                                <option value="08">Agosto</option>
                                <option value="09">Setembro</option>
                                <option value="10">Outubro</option>
                                <option value="11">Novembro</option>
                                <option value="12">Dezembro</option>
                            </select>
                        </div>
                        
                        <div class="date-row">
                            <input type="number" id="anoCartoes" name="anoCartoes" placeholder="Ano" min="1900" max="2100" step="1">
                        </div>
                    </div>
                                    
                    <div class="form-row button-row">
                        <button id="pesquisarCartoes" type="button">Pesquisar</button>
                    </div>
                </form>
            </div>
            



            
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    carregarEmpresasCartoes();
                    carregarRegionalCartoes();
                    carregarUnidadeCartoes();
                });
            
                function carregarEmpresasCartoes() {
                    const xhr = new XMLHttpRequest();
                    xhr.open('GET', "{% url 'listar_cartoes_ponto_inexistentes' %}?tipo=empresa", true);
                    xhr.onload = function () {
                        if (xhr.status >= 200 && xhr.status < 300) {
                            const data = JSON.parse(xhr.responseText);
                            const selectEmpresa = document.getElementById('empresaCartoes');
                            selectEmpresa.innerHTML = '';
                            const defaultOption = document.createElement('option');
                            defaultOption.value = '';
                            defaultOption.textContent = 'Empresa';
                            defaultOption.disabled = true;
                            defaultOption.selected = true;
                            selectEmpresa.appendChild(defaultOption);
                            const adicionadas = {};
                            data.forEach(function (item) {
                                if (!adicionadas[item.empresa]) {
                                    const option = document.createElement('option');
                                    option.value = item.id;
                                    option.textContent = item.empresa;
                                    selectEmpresa.appendChild(option);
                                    adicionadas[item.empresa] = true;
                                }
                            });
                        } else {
                            console.error('Erro ao carregar as empresas');
                        }
                    };
                    xhr.send();
                }
            
                function carregarRegionalCartoes() {
                    const xhr = new XMLHttpRequest();
                    xhr.open('GET', "{% url 'listar_cartoes_ponto_inexistentes' %}?tipo=regional", true);
                    xhr.onload = function () {
                        if (xhr.status >= 200 && xhr.status < 300) {
                            const data = JSON.parse(xhr.responseText);
                            const selectRegional = document.getElementById('RegionalCartoes');
                            selectRegional.innerHTML = '';
                            const defaultOption = document.createElement('option');
                            defaultOption.value = '';
                            defaultOption.textContent = 'Regional';
                            defaultOption.disabled = true;
                            defaultOption.selected = true;
                            selectRegional.appendChild(defaultOption);
                            const adicionadas = {};
                            data.forEach(function (item) {
                                if (!adicionadas[item.regional]) {
                                    const option = document.createElement('option');
                                    option.value = item.id;
                                    option.textContent = item.regional;
                                    selectRegional.appendChild(option);
                                    adicionadas[item.regional] = true;
                                }
                            });
                        } else {
                            console.error('Erro ao carregar as regionais');
                        }
                    };
                    xhr.send();
                }
            
                function carregarUnidadeCartoes() {
                    const xhr = new XMLHttpRequest();
                    xhr.open('GET', "{% url 'listar_cartoes_ponto_inexistentes' %}?tipo=unidade", true);
                    xhr.onload = function () {
                        if (xhr.status >= 200 && xhr.status < 300) {
                            const data = JSON.parse(xhr.responseText);
                            const selectUnidade = document.getElementById('UnidadeCartoes');
                            selectUnidade.innerHTML = '';
                            const defaultOption = document.createElement('option');
                            defaultOption.value = '';
                            defaultOption.textContent = 'Unidade';
                            defaultOption.disabled = true;
                            defaultOption.selected = true;
                            selectUnidade.appendChild(defaultOption);
                            const adicionadas = {};
                            data.forEach(function (item) {
                                if (!adicionadas[item.unidade]) {
                                    const option = document.createElement('option');
                                    option.value = item.id;
                                    option.textContent = item.unidade;
                                    selectUnidade.appendChild(option);
                                    adicionadas[item.unidade] = true;
                                }
                            });
                        } else {
                            console.error('Erro ao carregar as unidades');
                        }
                    };
                    xhr.send();
                }
            </script>
            
            
            
            <script>
                function openSidebarCartoes() {
                    // Obter o valor selecionado nos selects de empresa, regional e unidade
                    const selectedEmpresa = document.getElementById('empresaCartoes').value;
                    const selectedRegional = document.getElementById('RegionalCartoes').value;
                    const selectedUnidade = document.getElementById('UnidadeCartoes').value;
            
                    // Obter o valor do input de texto para o nome do colaborador
                    const nomeColaborador = document.getElementById('nomeCartoes').value.toLowerCase();
            
                    // Realizar uma solicitação AJAX para a view
                    const xhr = new XMLHttpRequest();
                    xhr.open('GET', "{% url 'listar_cartoes_ponto_inexistentes' %}", true);
                    xhr.onload = function () {
                        if (xhr.status >= 200 && xhr.status < 300) {
                            const data = JSON.parse(xhr.responseText);
                            const tbody = document.querySelector('#tabela-relatorio tbody');
                            tbody.innerHTML = ''; // Limpar o conteúdo atual da tabela
            
                            // Iterar sobre os dados e preencher a tabela
                            data.forEach(function (item) {
                                // Verificar se a linha corresponde a todos os filtros selecionados
                                if ((selectedEmpresa === '' || item.empresa === selectedEmpresa) &&
                                    (selectedRegional === '' || item.regional === selectedRegional) &&
                                    (selectedUnidade === '' || item.unidade === selectedUnidade) &&
                                    (nomeColaborador === '' || item.colaborador.toLowerCase().includes(nomeColaborador))) {
                                    const row = document.createElement('tr');
                                    row.innerHTML = `
                                        <td>${item.empresa}</td>
                                        <td>${item.regional}</td>
                                        <td>${item.unidade}</td>
                                        <td>${item.colaborador}</td>
                                        <td>${item.matricula}</td>
                                        <td>${item.cpf}</td>
                                        <td>${item.cargo}</td>
                                        <td>${item.data}</td>
                                        <td>${item.desligamento}</td>
                                        <td>${item.status}</td>
                                        <td>${item.tipo_documento}</td>
                                        <td><button onclick="visualizarDocumento('${item.id}')">Visualizar</button></td>
                                    `;
                                    tbody.appendChild(row);
                                }
                            });
            
                            // Abrir o sidebar após preencher a tabela
                            const sidebar = document.querySelector('.sidebar');
                            sidebar.classList.add('active');
                        } else {
                            console.error('Erro ao carregar os dados da view');
                        }
                    };
                    xhr.send();
                }
            
                // Adicionando evento de clique ao botão de pesquisarCartoes
                const pesquisarBtnCartoes = document.getElementById('pesquisarCartoes');
                pesquisarBtnCartoes.addEventListener('click', openSidebarCartoes);
            
                // Função para fechar o sidebar do Cartoes
                function closeSidebarCartoes() {
                    const sidebar = document.querySelector('.sidebar');
                    sidebar.classList.remove('active');
                }
            
                // Adicionando evento de clique ao botão de fechar do Cartoes
                const closeBtnCartoes = document.getElementById('closeBtnCartoes'); // Certifique-se de ter um botão com este ID
                closeBtnCartoes.addEventListener('click', closeSidebarCartoes);
            
                // Função para visualizar o documento (implemente conforme necessário)
                function visualizarDocumento(id) {
                    console.log('Visualizando documento com o ID:', id);
                }
            </script>
            
            
            
            
            
                



    <div id="DocumentosVencidosForm" class="form-container">
        <div class="subheader2">
            <p>DOCUMENTOS VENCIDOS</p>
        </div>
        <form>
            <div class="form-row">
                <select id="empresa" name="empresa" placeholder="Empresa" onclick="carregarEmpresas()">
                    <option value="empresa" disabled selected>Empresa</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Regional" name="Regional" placeholder="Regional" onclick="carregarRegional()">
                    <option value="Regional" disabled selected>Regional</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Unidade" name="Unidade" placeholder="Unidade" onclick="carregarUnidade()">
                    <option value="Unidade" disabled selected>Unidade</option>
                </select>
            </div>
            <div class="form-row">
                <input type="text" id="nome" name="nome" placeholder="Nome do Colaborador">
            </div>
            <div class="form-row">
                <input type="number" id="matricula" name="matricula" placeholder="Matrícula">
            </div>
            <div class="form-row">
                <input type="text" id="cpf" name="cpf" placeholder="CPF">
            </div>
            <div class="form-row">
                <select id="Cargo" name="Cargo" placeholder="Cargo" onclick="carregarCargo()">
                    <option value="Cargo" disabled selected>Cargo</option>
                </select>
            </div>
            <div class="form-row">
                <div class="date-row">
                    <input type="date" id="admissao" name="admissao" placeholder="Admissão">
                </div>
                <div class="date-row">
                    <input type="date" id="desligamento" name="desligamento" placeholder="Desligamento">
                </div>
            </div>
            <div class="form-row">
                <div class="date-row">
                    <input type="month" id="mes" name="mes" placeholder="mês">
                </div>
                <div class="date-row">
                    <input type="number" id="ano" name="ano" placeholder="ano" min="1900" max="2100" step="1">
                </div>
            </div>
            <div class="form-row">
                <select id="Tipo de Documento" name="Tipo de Documento" placeholder="Cargo" onclick="carregarTipoDeDocumento()">
                    <option value="Tipo de Documento" disabled selected>Tipo de Documento</option>
                </select>
            </div>                   
            <div class="form-row button-row">
                <button type="submit">Pesquisar</button>
            </div>
        </form>
    </div>





    <div id="documentosAVencerForm" class="form-container"> 
        <div class="subheader2">
            <p>DOCUMENTOS A VENCER</p>
        </div>
        <form>
            <div class="form-row">
                <select id="empresa" name="empresa" placeholder="Empresa" onclick="carregarEmpresas()">
                    <option value="empresa" disabled selected>Empresa</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Regional" name="Regional" placeholder="Regional" onclick="carregarRegional()">
                    <option value="Regional" disabled selected>Regional</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Unidade" name="Unidade" placeholder="Unidade" onclick="carregarUnidade()">
                    <option value="Unidade" disabled selected>Unidade</option>
                </select>
            </div>
            <div class="form-row">
                <input type="text" id="nome" name="nome" placeholder="Nome do Colaborador">
            </div>
            <div class="form-row">
                <input type="number" id="matricula" name="matricula" placeholder="Matrícula">
            </div>
            <div class="form-row">
                <input type="text" id="cpf" name="cpf" placeholder="CPF">
            </div>
            <div class="form-row">
                <select id="Cargo" name="Cargo" placeholder="Cargo" onclick="carregarCargo()">
                    <option value="Cargo" disabled selected>Cargo</option>
                </select>
            </div>
            <div class="form-row">
                <div class="date-row">
                    <input type="date" id="admissao" name="admissao" placeholder="Admissão">
                </div>
                <div class="date-row">
                    <input type="date" id="desligamento" name="desligamento" placeholder="Desligamento">
                </div>
            </div>
            <div class="form-row">
                <select id="Tipo de Documento" name="Tipo de Documento" placeholder="Cargo" onclick="carregarTipoDeDocumento()">
                    <option value="Tipo de Documento" disabled selected>Tipo de Documento</option>
                </select>
            </div>                  
            <div class="form-row button-row">
                <button type="submit">Pesquisar</button>
            </div>
        </form>
    </div>



    <div id="DocumentosAuditoriasForm" class="form-container">
        <div class="subheader2">
            <p>DOCUMENTOS PARA AUDITORIAS</p>
        </div>
        <form>
            <div class="form-row">
                <select id="empresa" name="empresa" placeholder="Empresa" onclick="carregarEmpresas()">
                    <option value="empresa" disabled selected>Empresa</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Regional" name="Regional" placeholder="Regional" onclick="carregarRegional()">
                    <option value="Regional" disabled selected>Regional</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Unidade" name="Unidade" placeholder="Unidade" onclick="carregarUnidade()">
                    <option value="Unidade" disabled selected>Unidade</option>
                </select>
            </div>
            <div class="form-row">
                <input type="text" id="nome" name="nome" placeholder="Nome do Colaborador">
            </div>
            <div class="form-row">
                <input type="text" id="matricula" name="matricula" placeholder="Matrícula">
            </div>
            <div class="form-row">
                <input type="text" id="cpf" name="cpf" placeholder="CPF">
            </div>
            <div class="form-row">
                <select id="Cargo" name="Cargo" placeholder="Cargo" onclick="carregarCargo()">
                    <option value="Cargo" disabled selected>Cargo</option>
                </select>
            </div>
            <div class="form-row">
                <div class="date-row">
                    <input type="date" id="admissao" name="admissao" placeholder="Admissão">
                </div>
                <div class="date-row">
                    <input type="date" id="desligamento" name="desligamento" placeholder="Desligamento">
                </div>
            </div>

            <div class="form-row">
                <select id="situacao" name="situacao" placeholder="Situação">
                    <option value="" disabled selected> Situação </option>
                    <option value="ativo">Ativo</option>
                    <option value="inativo">Inativo</option>
                </select>
            </div>
            <div class="form-row">
                <select id="Tipo de Documento" name="Tipo de Documento" placeholder="Cargo" onclick="carregarTipoDeDocumento()">
                    <option value="Tipo de Documento" disabled selected>Tipo de Documento</option>
                </select>
            </div>  
            <div class="form-row button-row">
                <button type="submit">Pesquisar</button>
            </div>
        </form>
    </div>



    <div id="RelatoriosGerenciaisForm" class="form-container">
        <div class="subheader2">
            <p>RELATÓRIOS GERENCIAIS</p>
        </div>
        <form>
            <div class="form-row">
                <div class="date-row">
                    <input type="date" id="dados ate o dia" name="dados ate o dia" placeholder="Dados até o dia">
                </div>
            </div>            
            
            <div class="form-row button-row">
                <button type="submit">Pesquisar</button>
            </div>
        </form>
    </div>


    <script src='{% static "bootstrap/js/src/relatorios.js" %}'></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.4/xlsx.full.min.js"></script>

{% endblock %}